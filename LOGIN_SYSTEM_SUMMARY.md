# HealthTrack 登录系统功能说明

## 概述
HealthTrack系统现在完全支持三种角色的登录：
1. **用户 (User)** - 普通健康管理用户
2. **医疗提供者 (Provider)** - 医疗专业人员
3. **管理员 (Admin)** - 系统管理员

## 登录功能

### 登录界面特性
- **角色选择下拉框**：用户可以选择三种角色之一进行登录
- **动态标签**：根据选择的角色，密码字段标签会自动切换：
  - 用户/管理员：显示"健康ID"
  - 医疗提供者：显示"执照号"
- **邮箱验证**：所有角色都通过邮箱地址进行身份验证

### 登录流程

#### 1. 用户 (User) 登录
- **输入**：邮箱地址 + 健康ID
- **验证**：通过邮箱查找用户，验证健康ID匹配
- **权限检查**：如果用户是管理员角色，会提示使用Admin角色登录
- **成功**：打开主菜单 (MainMenuFrame)

#### 2. 医疗提供者 (Provider) 登录
- **输入**：邮箱地址 + 医疗执照号
- **验证**：通过邮箱查找提供者，验证执照号匹配
- **成功**：打开提供者菜单 (ProviderMenuFrame)

#### 3. 管理员 (Admin) 登录
- **输入**：邮箱地址 + 健康ID
- **验证**：
  - 通过邮箱查找用户
  - 验证健康ID匹配
  - 验证角色为"Administrator"
- **成功**：打开管理员菜单 (AdminMenuFrame)

## 菜单功能

### 用户主菜单 (MainMenuFrame)
- 账户信息管理
- 预约管理
- 健康挑战管理
- 月度健康摘要
- 搜索记录
- 家庭组管理

### 医疗提供者菜单 (ProviderMenuFrame)
- 我的预约管理
- 个人信息管理
- 患者管理
- 预约统计

### 管理员菜单 (AdminMenuFrame)
- 用户管理
- 医疗提供者管理
- 系统统计
- 数据管理
- 系统设置
- 日志查看

## 技术实现

### 服务层
- **UserService**: 处理用户相关操作
- **ProviderService**: 处理医疗提供者相关操作
- 所有服务都通过Spring Boot自动扫描和注册

### 数据库支持
- `app_user` 表包含 `role` 字段，用于区分普通用户和管理员
- `provider` 表存储医疗提供者信息
- `user_email` 和 `provider_email` 表存储多值邮箱属性

### 安全特性
- 角色验证：确保用户使用正确的角色登录
- 服务初始化检查：确保所有必要的服务都已正确初始化
- 错误处理：提供友好的错误提示信息

## 测试数据

### 测试用户（管理员）
- 邮箱：`lisi@email.com`
- 健康ID：`user002`
- 角色：Administrator

### 测试医疗提供者
- 邮箱：`wangdoctor@hospital.com`
- 执照号：`doc001`

### 测试普通用户
- 邮箱：`zhangsan@email.com`
- 健康ID：`user001`

## 改进内容

1. **增强的Admin登录**：在Admin登录时，如果ProviderService未初始化，会自动尝试重新获取
2. **完善的错误处理**：所有登录路径都有完善的错误提示
3. **角色验证**：防止用户使用错误的角色登录

## 使用说明

1. 启动应用程序
2. 在登录界面选择角色（用户/医疗提供者/管理员）
3. 输入对应的邮箱地址
4. 输入对应的身份标识（健康ID或执照号）
5. 点击"登录"按钮
6. 成功登录后，会打开对应的菜单界面

## 注意事项

- 管理员必须使用"管理员 (Admin)"角色登录，不能使用"用户 (User)"角色
- 医疗提供者必须使用"医疗提供者 (Provider)"角色登录
- 所有邮箱地址必须在数据库中已注册
- 健康ID和执照号必须与邮箱地址匹配


